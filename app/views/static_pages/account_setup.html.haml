.container-fluid
	.row.account-setup-page
		= form_for @company, :url=>"/update_profile", :html=>{:class=>"form-horizontal edit_submission", :"data-validate" => "parsley", :multipart => true, :id=>"company_info_form"} do |f|
			.row.first-row
				.span6
					%p.page-title PPDM Solutions Inc
				.span4{:style=>"padding-top: 15px;"}
					%input.btn.btn-primary{:type=>"submit", :value=>"Update Profile"} 
					%a.btn.btn-success{:href=>"/change_passwd"} Change Pssword
			.row.company-info-row
				.row.head-row
					%p.item-title Company Info
				.row
					.span3
						%img#uploadPreview{:style=>"width: 150px; height: 150px;margin-left:25px;", :src=>"data:image/svg+xml,%3C%3Fxml%20version%3D%221.0%22%3F%3E%0A%3Csvg%20width%3D%22153%22%20height%3D%22153%22%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%3E%0A%20%3Cg%3E%0A%20%20%3Ctitle%3ENo%20image%3C/title%3E%0A%20%20%3Crect%20id%3D%22externRect%22%20height%3D%22150%22%20width%3D%22150%22%20y%3D%221.5%22%20x%3D%221.500024%22%20stroke-width%3D%223%22%20stroke%3D%22%23666666%22%20fill%3D%22%23e1e1e1%22/%3E%0A%20%20%3Ctext%20transform%3D%22matrix%286.66667%2C%200%2C%200%2C%206.66667%2C%20-960.5%2C%20-1099.33%29%22%20xml%3Aspace%3D%22preserve%22%20text-anchor%3D%22middle%22%20font-family%3D%22Fantasy%22%20font-size%3D%2214%22%20id%3D%22questionMark%22%20y%3D%22181.249569%22%20x%3D%22155.549819%22%20stroke-width%3D%220%22%20stroke%3D%22%23666666%22%20fill%3D%22%23000000%22%3E%3F%3C/text%3E%0A%20%3C/g%3E%0A%3C/svg%3E", :alt=>"Image preview"}
						%br/
						%br/
						%a.file-input-wrapper.btn.undefined.offset2{:style => "cursor: pointer;height: 20px;margin-left: 0;margin-top: 0;"}
							Upload Logo/Picture
							%input#company_picture_attributes_image{:name => "company[picture_attributes][image]", :onchange => "loadImageFile();", :size => "5", :style => "margin-top:-45px;opacity: 0;", :type => "file", :"data-required"=>"true"}/
					.span7
						.control-group
							= f.label "Address Line1:",:class => 'control-label'
							.controls
								= f.text_field :address1, :class => 'text_field long-text', :"data-required"=>"true"
								%small Street address, P.O. box, company name, c/o
						.control-group
							= f.label "Address Line2:",:class => 'control-label'
							.controls
								= f.text_field :address2, :class => 'text_field long-text'
								%small Apartment, suite, unit, building, floor, etc.
						.control-group
							= f.label "City:",:class => 'control-label'
							.controls
								= f.text_field :city, :class => 'text_field', :"data-required"=>"true"
						.control-group
							= f.label "State:",:class => 'control-label'
							.controls
								= f.text_field :state, :class => 'text_field', :"data-required"=>"true"
						.control-group
							= f.label "Zip:",:class => 'control-label'
							.controls
								= f.text_field :zip, :class => 'text_field', :"data-required"=>"true"
						.control-group
							= f.label "Country:",:class => 'control-label'
							.controls
								= f.text_field :country, :class => 'text_field', :"data-required"=>"true"
						.control-group
							= f.label "Website:",:class => 'control-label'
							.controls
								= f.text_field :website, :class => 'text_field'
			.row.contact-info-row
				.row.head-row
					%p.item-title Contact Info
				.row
					.span8
						.control-group
							%label.control-label "Name:"
							.controls
								%input#contact_name.text_field.parsley-validated{:type=>"text", :value=>current_user.full_name, :name=>"contact[name]", :"data-required"=>"true"}/
						.control-group
							%label.control-label "Email:"
							.controls
								%input#contact_email.text_field.parsley-validated{:"data-required" => "true", :name => "contact[email]", :type => "text", :value => current_user.email}/
						.control-group
							%label.control-label "Phone Number:"
							.controls
								%input#contact_phone_number.text_field.parsley-validated{:"data-required" => "true", :name => "contact[phone_number]", :type => "text"}/
			.row.company-details-row
				.row.head-row
					%p.item-title Company Details
				.row
					.span8
						.control-group
							%label.control-label Sponsor/Transfer H-1B
							.controls
								.span3
									= f.radio_button :sp_transfer, :yes, :class => 'custom-radio-button1'
									%label{:for => "company_sp_transfer_yes"} Yes
								.span3
									= f.radio_button :sp_transfer, :no, :class => 'custom-radio-button1'
									%label{:for => "company_sp_transfer_no"} No
						.control-group
							= f.label "Everified:",:class => 'control-label'
							.controls
								.span3
									= f.radio_button :everified, :yes, :class => 'custom-radio-button2' 
									%label{:for => "company_everified_yes"} Yes
								.span3
									= f.radio_button :everified, :no, :class => 'custom-radio-button2'
									%label{:for => "company_everified_no"} No
						.control-group
							= f.label "Training Provided:",:class => 'control-label'
							.controls
								.span3
									= f.radio_button :training_provided, :yes, :class => 'custom-radio-button3' 
									%label{:for => "company_training_provided_yes"} Yes
								.span3
									= f.radio_button :training_provided, :no, :class => 'custom-radio-button3'
									%label{:for => "company_training_provided_no"} No
						.control-group
							= f.label "Accommodation:",:class => 'control-label'
							.controls
								.span3
									= f.radio_button :accommodation, :yes, :class => 'custom-radio-button4'
									%label{:for => "company_accommodation_yes"} Yes
								.span3
									= f.radio_button :accommodation, :no, :class => 'custom-radio-button4'
									%label{:for => "company_accommodation_no"} No
						%ul#parsley-select-option.parsley-error-list{:style => "display: none;"}
							%li.required{:style => "display: list-item;"} Please select option.
						.control-group
							= f.label "About:",:class => 'control-label'
							.controls
								= f.text_area :description, :class => 'text_field', :style=>"height: 120px;width: 640px;"
			
:javascript
	$("#company_city").autocomplete({
		source: function (request, response) {
			$.ajax({
				url: "http://ws.geonames.org/searchJSON?country=US",
				dataType: "jsonp",
				data: {
					featureClass: "P",
					style: "full",
					maxRows: 12,
					name_startsWith: request.term
				},
				success: function (data) {
					response($.map(data.geonames, function (item) {
						return {
							label: item.name + (item.adminName1 ? ", " + item.adminName1 : ""),
							value: item.name,
							state: item.adminCode1,
							zip: item.adminCode2,
							country: item.countryName
						}
					}));
				}
			});
		},
		minLength: 2,
		select: function (event, ui) {
			$("#company_state").val(ui.item.state);
			$("#company_zip").val(ui.item.zip);
			$("#company_country").val(ui.item.country);
			$("#company_website").focus();
		}		
	});	
	$('input.custom-radio-button1').customInput();
	$('input.custom-radio-button2').customInput();
	$('input.custom-radio-button3').customInput();
	$('input.custom-radio-button4').customInput();


	oFReader = new FileReader(), rFilter = /^(?:image\/bmp|image\/cis\-cod|image\/gif|image\/ief|image\/jpeg|image\/jpeg|image\/jpeg|image\/pipeg|image\/png|image\/svg\+xml|image\/tiff|image\/x\-cmu\-raster|image\/x\-cmx|image\/x\-icon|image\/x\-portable\-anymap|image\/x\-portable\-bitmap|image\/x\-portable\-graymap|image\/x\-portable\-pixmap|image\/x\-rgb|image\/x\-xbitmap|image\/x\-xpixmap|image\/x\-xwindowdump)$/i;
 
	oFReader.onload = function (oFREvent) {
		document.getElementById("uploadPreview").src = oFREvent.target.result;
	};
	 
	function loadImageFile() {
		if (document.getElementById("company_picture_attributes_image").files.length === 0) { return; }
		var oFile = document.getElementById("company_picture_attributes_image").files[0];
		if (!rFilter.test(oFile.type)) { alert("You must select a valid image file!"); return; }
		oFReader.readAsDataURL(oFile);
	}
	
	$("#company_info_form").submit(function(){
		console.log("SUBMIT");
		var selected_option = false
		$("div.custom-radio label").each(function(){
			if($(this).hasClass("checked")){
				selected_option = true;
			}
		});

		if(selected_option==false){
			$("#parsley-select-option").show();
			return false;
		}else{
			$("#parsley-select-option").hide();
			return true;
		}
		return selected_option;
	});